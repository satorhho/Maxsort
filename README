I literally just dreamed of this algorithm and woke up to code this